{% extends 'layout.html' %}
{% block content %}

<style>

  #audio-player {
    width: 100%;
    height: 50px;
    position: relative;
  }
  
  #audio-controls {
    position: absolute;
    top: 0;
    left: 0;
  }
  
  #audio-timeline {
    position: absolute;
    top: 0;
    left: 60px;
    width: calc(100% - 60px);
    height: 100%;
  }
  
  #timeline-dot {
    position: absolute;
    top: 0;
    left: 0;
    width: 5px;
    height: 100%;
    background-color: red;
  }  

</style>

<div class="card">
  <div class="card-body">
    <div id="audio-player">
      <div id="audio-controls"  >
        <button id="play-button" onclick="play()">Play</button>
        <button id="stop-button" onclick="pause()">Pause</button>
      </div>
    </div>
  </div>
</div>

<script>

// Create a new Howl object for the audio file
var sound = new Howl({
  src: ["{{url_for('static', filename='uploads/audios/13.mp3')}}"]
});

// Play button click event
function play() {
  sound.stop()
  sound.play();
}

// Stop button click event
function pause() {
  sound.pause();
}

// Update the timeline dot position as the audio plays
var timelineDot = document.getElementById('timeline-dot');
sound.on('play', function() {
  var update = setInterval(function() {
    var timelineWidth = document.getElementById('audio-timeline').offsetWidth;
    var dotPosition = (sound.seek() / sound.duration()) * timelineWidth;
    timelineDot.style.left = dotPosition + 'px';
  }, 50);
});

// Move the dot to change the audio playback position
timelineDot.addEventListener('mousedown', function() {
  var timelineWidth = document.getElementById('audio-timeline').offsetWidth;
  var onMouseMove = function(event) {
    var dotPosition = event.clientX - 60;
    if (dotPosition >= 0 && dotPosition <= timelineWidth) {
      timelineDot.style.left = dotPosition + 'px';
    }
  };
  document.addEventListener('mousemove', onMouseMove);
  document.addEventListener('mouseup', function() {
    var seekPosition = (timelineDot.offsetLeft / timelineWidth) * sound.duration();
    sound.seek(seekPosition);
    document.removeEventListener('mousemove', onMouseMove);
  });
});

</script>

{% endblock %}